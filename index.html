<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Meta Tags -->
    <title>Delicias Urbanas | Pollos al Spiedo y S치ndwiches en Salta</title>
    <meta name="description" content="Ped칤 online los mejores pollos al spiedo, s치ndwiches de miga y bebidas en Salta. Retiro r치pido por nuestro local.">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Montserrat:wght@700;800&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Generative AI Import Map -->
    <script type="importmap">
{
  "imports": {
    "@google/genai": "https://esm.sh/@google/genai@0.1.0",
    "react/": "https://esm.sh/react@^19.2.3/",
    "react": "https://esm.sh/react@^19.2.3",
    "lucide-react": "https://esm.sh/lucide-react@^0.562.0"
  }
}
</script>

    <style>
        body { font-family: 'Inter', sans-serif; }
        h1, h2, h3, h4, .font-heading { font-family: 'Montserrat', sans-serif; }
        
        /* Scrollbar Personalizado */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Utilidades de UI */
        .drawer-open { transform: translateX(0) !important; }
        .modal-open { display: flex !important; }
        
        /* Animaciones */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .animate-fade-in { animation: fadeIn 0.3s ease-out; }
        
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .animate-slide-up { animation: slideUp 0.5s ease-out forwards; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 overflow-x-hidden relative">

    <!-- DATA STORE -->
    <script>
        const SHOP_INFO = {
            name: "Delicias Urbanas",
            phone: "5493875020884", 
            phoneDisplay: "+54 9 387 502-0884",
            address: "Av. San Mart칤n 532, Salta",
            addressFull: "Av. San Mart칤n 532, Salta, Argentina",
            logoUrl: "https://lh3.googleusercontent.com/d/1hRktdsvA2ed5jfrkQRQ3xbbotozlgTBl",
            instagram: "https://instagram.com/delicias.urbanas",
            instagramUser: "@delicias.urbanas"
        };

        const MENU_ITEMS = [
            { id: 'p1', name: 'Pollo al Spiedo Entero', description: 'Nuestro cl치sico pollo asado lentamente al spiedo, tierno y sabroso.', price: 15000, category: 'Pollo', image: 'https://images.unsplash.com/photo-1626645738196-c2a7c87a8f58?auto=format&fit=crop&q=80&w=600' },
            { id: 'p2', name: 'Medio Pollo al Spiedo', description: 'La mitad de nuestro famoso pollo al spiedo.', price: 11000, category: 'Pollo', image: 'https://images.unsplash.com/photo-1588166524941-3bf61a9c41db?auto=format&fit=crop&q=80&w=600' },
            { id: 'g1', name: 'Guarnici칩n de Arroz', description: 'Arroz blanco al dente, el acompa침amiento ideal.', price: 2000, category: 'Guarniciones', image: 'https://images.unsplash.com/photo-1539755530862-00f623c00f52?auto=format&fit=crop&q=80&w=600' },
            { id: 'g2', name: 'Papas Doradas al Horno', description: 'Papas cortadas en cubos, doradas al horno con un toque de romero.', price: 3000, category: 'Guarniciones', image: 'https://images.unsplash.com/photo-1619684784943-415eb634e062?auto=format&fit=crop&q=80&w=600' },
            { id: 's1', name: 'S치ndwich Jam칩n y Queso', description: 'Cl치sico s치ndwich con abundante jam칩n cocido y queso tybo.', price: 1500, category: 'S치ndwiches', image: 'https://images.unsplash.com/photo-1553909489-cd47e0907d3f?auto=format&fit=crop&q=80&w=600' },
            { id: 's2', name: 'S치ndwich Salame y Queso', description: 'Sabroso salame mil치n y queso en fetas en pan fresco.', price: 1500, category: 'S치ndwiches', image: 'https://images.unsplash.com/photo-1626078299034-75466d7412f1?auto=format&fit=crop&q=80&w=600' },
            { id: 's3', name: 'S치ndwich Ternera y Queso', description: 'Finas fetas de ternera con queso derretido o natural.', price: 2000, category: 'S치ndwiches', image: 'https://images.unsplash.com/photo-1481070414801-51fd732d7184?auto=format&fit=crop&q=80&w=600' },
            { id: 's4', name: 'S치ndwich Ternera y Lechuga', description: 'Ternera seleccionada con lechuga fresca y crocante.', price: 2000, category: 'S치ndwiches', image: 'https://images.unsplash.com/photo-1509722747041-619f383b8326?auto=format&fit=crop&q=80&w=600' },
            { id: 's5', name: 'Ternera, Tomate y Huevo', description: 'Completo: ternera, tomate fresco y huevo duro picado.', price: 2500, category: 'S치ndwiches', image: 'https://images.unsplash.com/photo-1547496502-ffa222d79a80?auto=format&fit=crop&q=80&w=600' },
            { id: 's6', name: 'Aceituna, Huevo y Queso', description: 'Opci칩n vegetariana con aceitunas verdes, huevo y mucho queso.', price: 2500, category: 'S치ndwiches', image: 'https://images.unsplash.com/photo-1539252554452-da37fa1d9357?auto=format&fit=crop&q=80&w=600' },
            { id: 's7', name: 'Roquefort y Jam칩n', description: 'Para los amantes del sabor fuerte: roquefort premium y jam칩n.', price: 2500, category: 'S치ndwiches', image: 'https://images.unsplash.com/photo-1559466273-d95e71deb58a?auto=format&fit=crop&q=80&w=600' },
            { id: 's8', name: 'Jam칩n Crudo y Queso', description: 'Jam칩n crudo estacionado y queso de campo.', price: 2500, category: 'S치ndwiches', image: 'https://images.unsplash.com/photo-1600271886742-f049cd451bba?auto=format&fit=crop&q=80&w=600' },
            { id: 's9', name: 'S치ndwich de Milanesa', description: 'Cl치sico argentino: milanesa de carne en pan franc칠s con lechuga y tomate.', price: 4500, category: 'S치ndwiches', image: 'https://images.unsplash.com/photo-1619860860774-1e2e17343432?auto=format&fit=crop&q=80&w=600' },
            { id: 's10', name: 'Baguette Especial', description: 'S치ndwich en pan baguette con ingredientes a elecci칩n.', price: 3000, category: 'S치ndwiches', image: 'https://images.unsplash.com/photo-1627308595229-7830a5c91f9f?auto=format&fit=crop&q=80&w=600' },
            { id: 's11', name: 'Pebete', description: 'Cl치sico pan pebete suave con jam칩n y queso.', price: 1000, category: 'S치ndwiches', image: 'https://images.unsplash.com/photo-1525351484163-7529414344d8?auto=format&fit=crop&q=80&w=600' },
            { id: 'b1', name: 'Coca Cola 250ml', description: 'Botella de vidrio o lata peque침a bien helada.', price: 1500, category: 'Bebidas', image: 'https://images.unsplash.com/photo-1622483767028-3f66f32aef97?auto=format&fit=crop&q=80&w=600' },
            { id: 'b2', name: 'Fanta 250ml', description: 'Sabor naranja refrescante.', price: 1500, category: 'Bebidas', image: 'https://images.unsplash.com/photo-1624517452488-04869289c4ca?auto=format&fit=crop&q=80&w=600' },
            { id: 'b3', name: 'Sprite 250ml', description: 'Sabor lima-lim칩n.', price: 1500, category: 'Bebidas', image: 'https://images.unsplash.com/photo-1625772290748-39093c022a16?auto=format&fit=crop&q=80&w=600' },
            { id: 'b4', name: 'Coca Cola 350ml', description: 'Lata cl치sica.', price: 2000, category: 'Bebidas', image: 'https://images.unsplash.com/photo-1554866585-cd94860890b7?auto=format&fit=crop&q=80&w=600' },
            { id: 'b5', name: 'Fanta 350ml', description: 'Lata de Fanta naranja.', price: 2000, category: 'Bebidas', image: 'https://images.unsplash.com/photo-1613478223719-2ab802602423?auto=format&fit=crop&q=80&w=600' },
            { id: 'b6', name: 'Sprite 350ml', description: 'Lata de Sprite lima-lim칩n.', price: 2000, category: 'Bebidas', image: 'https://images.unsplash.com/photo-1543253687-c931c8e01820?auto=format&fit=crop&q=80&w=600' },
            { id: 'b7', name: 'Coca Cola 600ml', description: 'Botella individual.', price: 2500, category: 'Bebidas', image: 'https://images.unsplash.com/photo-1596803244618-8dce7f5067d8?auto=format&fit=crop&q=80&w=600' },
            { id: 'b8', name: 'Fanta 600ml', description: 'Botella individual de Fanta.', price: 2500, category: 'Bebidas', image: 'https://images.unsplash.com/photo-1613478223719-2ab802602423?auto=format&fit=crop&q=80&w=600' },
            { id: 'b9', name: 'Sprite 600ml', description: 'Botella individual de Sprite.', price: 2500, category: 'Bebidas', image: 'https://images.unsplash.com/photo-1625772290748-39093c022a16?auto=format&fit=crop&q=80&w=600' },
            { id: 'b10', name: 'Monster Energy', description: 'Cualquier sabor disponible (Original, Mango Loco, Ultra, etc).', price: 4500, category: 'Bebidas', image: 'https://images.unsplash.com/photo-1622543925917-763c34d1538c?auto=format&fit=crop&q=80&w=600' }
        ];

        // Estado Global
        let cart = [];
        let orders = JSON.parse(localStorage.getItem('delicias_urbanas_orders') || '[]');
        let selectedCategory = 'Todos';
        let searchQuery = '';
    </script>

    <!-- HEADER -->
    <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-slate-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16 sm:h-20">
                <!-- Logo -->
                <div class="flex items-center space-x-3 group cursor-pointer transition-transform duration-300 hover:scale-105" onclick="window.scrollTo({top:0, behavior:'smooth'})">
                    <div class="w-12 h-12 rounded-full overflow-hidden border-2 border-orange-500 shadow-lg shadow-orange-500/20 bg-white">
                        <img id="header-logo" src="" alt="Logo" class="w-full h-full object-contain p-0.5">
                    </div>
                    <div>
                        <h1 class="text-xl sm:text-2xl font-black text-slate-900 tracking-tighter leading-none italic uppercase font-heading">
                            DELICIAS <span class="text-orange-500">URBANAS</span>
                        </h1>
                        <p class="text-[10px] sm:text-xs font-black text-slate-400 uppercase tracking-widest">
                            Comidas al Paso
                        </p>
                    </div>
                </div>

                <!-- Botones Header -->
                <div class="flex items-center gap-3">
                    <button onclick="toggleOrders(true)" class="p-3 text-slate-600 hover:text-orange-500 transition-all duration-300 ease-out group flex flex-col items-center hover:bg-slate-50 rounded-2xl active:scale-95 hover:scale-105" title="Mis Pedidos">
                        <i data-lucide="clipboard-list" class="w-6 h-6"></i>
                        <span class="text-[10px] font-black uppercase hidden sm:block mt-1">Mis Pedidos</span>
                    </button>
                    
                    <button onclick="toggleCart(true)" class="relative p-3 text-slate-600 hover:text-orange-500 transition-all duration-300 ease-out group flex flex-col items-center hover:bg-slate-50 rounded-2xl active:scale-95 hover:scale-105" title="Mi Carrito">
                        <i data-lucide="shopping-cart" class="w-6 h-6"></i>
                        <span class="text-[10px] font-black uppercase hidden sm:block mt-1">Carrito</span>
                        <span id="cart-badge" class="hidden absolute top-2 right-2 inline-flex items-center justify-center px-2 py-1 text-[10px] font-black leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-orange-600 rounded-full shadow-lg border-2 border-white">0</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- HERO SECTION -->
    <section class="bg-[#0f1113] text-white py-16 sm:py-24 overflow-hidden relative">
        <div class="absolute top-0 right-0 w-80 h-80 bg-orange-600/10 rounded-full -translate-y-1/2 translate-x-1/2 blur-3xl"></div>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative">
            <div class="flex flex-col md:flex-row items-center gap-10">
                <div class="w-48 h-48 sm:w-64 sm:h-64 rounded-full border-4 border-orange-500 p-1 flex-shrink-0 bg-white overflow-hidden shadow-[0_0_50px_rgba(249,115,22,0.4)] transition-transform duration-700 hover:rotate-3 hover:scale-105">
                    <img id="hero-logo" src="" alt="Logo" class="w-full h-full object-contain p-2">
                </div>
                <div class="text-center md:text-left">
                    <div class="flex flex-col sm:flex-row items-center gap-4 mb-4">
                        <h2 class="text-4xl sm:text-5xl font-black tracking-tighter italic uppercase font-heading animate-fade-in">
                            DELICIAS <span class="text-orange-500">URBANAS</span>
                        </h2>
                        <div class="flex gap-2">
                            <span class="bg-slate-800 text-xs font-bold px-3 py-1 rounded-full text-slate-300">Restaurante</span>
                            <span class="bg-orange-500 text-xs font-bold px-3 py-1 rounded-full text-white">Salta</span>
                        </div>
                    </div>
                    <p class="text-slate-400 text-lg sm:text-xl font-medium mb-6 max-w-xl leading-relaxed">
                        Somos Delicias Urbanas, un lugar en donde vas a encontrar una variedad de comidas y bebidas riqu칤simas. 游꼥游볽游볭游볷
                    </p>
                    <div class="flex flex-wrap justify-center md:justify-start gap-4">
                        <div class="flex items-center gap-2 text-slate-300 bg-white/5 px-4 py-2 rounded-xl border border-white/10 transition-all duration-300 hover:bg-white/10 cursor-default hover:scale-105">
                            <i data-lucide="map-pin" class="w-4 h-4 text-orange-500"></i>
                            <span class="text-sm font-bold" id="hero-address"></span>
                        </div>
                        <a id="hero-instagram" href="#" target="_blank" class="flex items-center gap-2 text-slate-300 hover:text-white transition-all duration-300 bg-white/5 hover:bg-white/10 hover:scale-105 active:scale-95 px-4 py-2 rounded-xl border border-white/10">
                            <i data-lucide="instagram" class="w-4 h-4 text-pink-500"></i>
                            <span class="text-sm font-bold" id="hero-instagram-user"></span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FILTERS & SEARCH -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 -mt-10 relative z-10">
        <div class="bg-white rounded-[2.5rem] shadow-2xl p-4 sm:p-8 border border-slate-100">
            <div class="flex flex-col md:flex-row gap-6 md:items-center">
                <div class="relative flex-1">
                    <i data-lucide="search" class="absolute left-6 top-1/2 -translate-y-1/2 text-slate-400 w-5 h-5"></i>
                    <input type="text" id="search-input" placeholder="쯈u칠 delicia busc치s hoy?" 
                           class="w-full bg-slate-50 border border-slate-100 rounded-2xl py-5 pl-14 pr-6 focus:outline-none focus:ring-4 focus:ring-orange-500/10 font-medium text-lg transition-all">
                </div>
                <div class="flex gap-2 overflow-x-auto pb-2 md:pb-0 no-scrollbar" id="category-container">
                    <!-- Categor칤as inyectadas por JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- MAIN MENU -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
        <div class="mb-10 flex items-center justify-between">
            <h2 id="menu-title" class="text-3xl font-black text-slate-900 tracking-tighter uppercase italic font-heading">
                NUESTRO MEN칔
            </h2>
        </div>
        <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
            <!-- Productos inyectados por JS -->
        </div>
    </main>

    <!-- STATUS & WHATSAPP SECTION -->
    <section class="flex min-h-[60vh] items-center justify-center px-6 py-20 bg-white overflow-hidden border-t border-slate-100">
        <div class="relative flex flex-col items-center gap-12 max-w-4xl w-full">
             
             <!-- Indicador de Estado -->
             <div class="flex items-center gap-3 transition-all duration-500 bg-slate-50 px-4 py-2 rounded-full border border-slate-100 shadow-sm" id="status-badge">
                <span class="relative flex size-2">
                    <span id="status-dot-ping" class="absolute inline-flex h-full w-full animate-ping rounded-full opacity-75 bg-slate-400"></span>
                    <span id="status-dot" class="relative inline-flex size-2 rounded-full transition-colors duration-500 bg-slate-500"></span>
                </span>
                <span id="status-text" class="text-xs sm:text-sm font-black tracking-widest uppercase text-slate-600 tabular-nums">Cargando...</span>
            </div>

            <!-- Bot칩n Grande -->
            <div class="group relative cursor-pointer" onclick="openWhatsApp()">
                <div class="flex flex-col items-center gap-6">
                    <h2 class="relative text-center text-5xl font-black tracking-tighter text-slate-900 sm:text-6xl md:text-7xl lg:text-8xl uppercase italic font-heading hover:scale-105 transition-transform duration-500">
                        <span class="block">쮿acemos</span>
                        <span class="block text-orange-500">un pedido?</span>
                    </h2>
                    <div class="relative mt-4 flex size-16 items-center justify-center sm:size-20 bg-orange-500 rounded-full text-white shadow-xl hover:bg-slate-900 transition-colors duration-300">
                        <i data-lucide="arrow-up-right" class="size-8"></i>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="bg-[#0f1113] text-slate-500 py-20 border-t border-white/5">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-12 text-center sm:text-left">
                <div>
                    <div class="flex items-center gap-3 mb-6 justify-center sm:justify-start">
                        <img id="footer-logo" src="" class="w-10 h-10 rounded-full border border-orange-500" alt="logo">
                        <h1 class="text-white font-black italic uppercase text-xl font-heading">DELICIAS <span class="text-orange-500">URBANAS</span></h1>
                    </div>
                    <p class="text-sm text-slate-400">Sabores aut칠nticos en el coraz칩n de Salta.</p>
                </div>
                <div>
                    <h4 class="text-white font-bold mb-4 uppercase tracking-widest text-xs flex items-center gap-2 justify-center sm:justify-start">
                        <i data-lucide="clock" class="w-4 h-4 text-orange-500"></i> Horarios
                    </h4>
                    <div class="space-y-2">
                        <p class="text-sm text-slate-300 font-bold">Lunes a S치bado</p>
                        <p class="text-sm text-slate-400">08:00 - 15:00 hs</p>
                        <p class="text-sm text-slate-400">17:30 - 21:00 hs</p>
                    </div>
                </div>
                <div>
                    <h4 class="text-white font-bold mb-4 uppercase tracking-widest text-xs flex items-center gap-2 justify-center sm:justify-start">
                        <i data-lucide="map-pin" class="w-4 h-4 text-orange-500"></i> Ubicaci칩n
                    </h4>
                    <p class="text-sm text-slate-400" id="footer-address"></p>
                </div>
                <div>
                    <h4 class="text-white font-bold mb-4 uppercase tracking-widest text-xs flex items-center gap-2 justify-center sm:justify-start">
                        <i data-lucide="phone" class="w-4 h-4 text-orange-500"></i> Contacto
                    </h4>
                    <p class="text-sm text-slate-400 mb-2" id="footer-phone"></p>
                    <a id="footer-instagram-link" href="#" target="_blank" class="text-sm text-orange-500 hover:text-white transition-colors flex items-center gap-2 justify-center sm:justify-start font-bold">
                        <i data-lucide="instagram" class="w-4 h-4"></i> Seguir en Instagram
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- CART DRAWER -->
    <div id="cart-drawer" class="fixed inset-0 z-[100] overflow-hidden hidden">
        <div class="absolute inset-0 bg-slate-900/40 backdrop-blur-sm transition-opacity" onclick="toggleCart(false)"></div>
        <div class="absolute inset-y-0 right-0 max-w-full flex">
            <div id="cart-drawer-panel" class="w-screen max-w-md bg-white shadow-2xl flex flex-col transform translate-x-full transition-transform duration-300">
                <div class="flex-1 overflow-y-auto px-4 py-6 sm:px-6 custom-scrollbar">
                    <div class="flex items-start justify-between mb-8">
                        <div>
                            <h2 class="text-2xl font-black text-slate-900 italic uppercase tracking-tighter flex items-center gap-2 font-heading">
                                <i data-lucide="shopping-bag" class="w-6 h-6 text-orange-500"></i> Tu Pedido
                            </h2>
                            <p class="text-xs font-bold text-slate-400 uppercase tracking-widest mt-1">Revis치 tus 칤tems</p>
                        </div>
                        <button onclick="toggleCart(false)" class="p-2 bg-slate-50 text-slate-400 hover:text-slate-600 rounded-xl hover:bg-slate-100">
                            <i data-lucide="x" class="w-6 h-6"></i>
                        </button>
                    </div>
                    <div id="cart-items-container">
                        <!-- Items -->
                    </div>
                </div>
                <div id="cart-footer" class="border-t border-slate-100 px-6 py-6 bg-white shadow-[0_-10px_40px_rgba(0,0,0,0.05)] z-10 hidden">
                    <div class="flex justify-between items-end mb-6">
                        <span class="text-xs font-bold text-slate-400 uppercase tracking-widest">Total Final</span>
                        <span class="text-3xl font-black text-slate-900 tracking-tighter" id="cart-total">$0</span>
                    </div>
                    <button onclick="openCheckout()" class="w-full bg-slate-900 text-white rounded-2xl py-5 font-black text-sm uppercase tracking-wider hover:bg-orange-600 transition-all duration-300 shadow-xl shadow-slate-900/20 hover:shadow-orange-600/30 active:scale-[0.98] flex items-center justify-center gap-2 group">
                        Confirmar Pedido <i data-lucide="arrow-right" class="w-4 h-4 transition-transform group-hover:translate-x-1"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ORDERS DRAWER -->
    <div id="orders-drawer" class="fixed inset-0 z-[100] overflow-hidden hidden">
        <div class="absolute inset-0 bg-slate-900/40 backdrop-blur-sm transition-opacity" onclick="toggleOrders(false)"></div>
        <div class="absolute inset-y-0 left-0 max-w-full flex">
            <div id="orders-drawer-panel" class="w-screen max-w-md bg-white shadow-2xl flex flex-col transform -translate-x-full transition-transform duration-300">
                <div class="flex-1 overflow-y-auto px-4 py-6 sm:px-6">
                    <div class="flex items-start justify-between">
                        <h2 class="text-2xl font-bold text-slate-900 flex items-center gap-2 font-heading">
                            <i data-lucide="clipboard-list" class="w-6 h-6 text-orange-500"></i> Mis Pedidos
                        </h2>
                        <button onclick="toggleOrders(false)" class="p-2 text-slate-400 hover:text-slate-500">
                            <i data-lucide="x" class="w-6 h-6"></i>
                        </button>
                    </div>
                    <div id="orders-list" class="mt-8 space-y-6"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- CHECKOUT MODAL -->
    <div id="checkout-modal" class="fixed inset-0 z-[110] hidden items-center justify-center p-0 sm:p-4">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-md" onclick="closeCheckout()"></div>
        <div class="relative bg-white sm:rounded-3xl w-full max-w-lg shadow-2xl overflow-hidden h-full sm:h-auto sm:max-h-[95vh] flex flex-col animate-fade-in">
            <!-- Step 1: Formulario -->
            <form id="checkout-form" class="flex flex-col h-full" onsubmit="handleCheckoutSubmit(event)">
                <div class="px-6 py-5 border-b border-slate-100 bg-white z-20 shadow-sm flex-shrink-0">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-extrabold text-slate-900 italic uppercase tracking-tighter flex items-center gap-2 font-heading">
                            <i data-lucide="store" class="w-6 h-6 text-orange-500"></i> Datos de Retiro
                        </h2>
                        <button type="button" onclick="closeCheckout()" class="p-2 -mr-2 text-slate-400 hover:text-slate-600">
                            <i data-lucide="x" class="w-6 h-6"></i>
                        </button>
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div class="flex items-center gap-2 bg-slate-50 p-2.5 rounded-xl border border-slate-200">
                            <div class="bg-white p-1.5 rounded-lg shadow-sm text-slate-400"><i data-lucide="map-pin" class="w-4 h-4"></i></div>
                            <div class="flex flex-col overflow-hidden">
                                <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest leading-none mb-1">Direcci칩n</span>
                                <span class="text-xs font-bold text-slate-800 truncate leading-none" id="checkout-address"></span>
                            </div>
                        </div>
                        <div class="flex items-center gap-2 bg-slate-50 p-2.5 rounded-xl border border-slate-200">
                            <div class="bg-white p-1.5 rounded-lg shadow-sm text-slate-400"><i data-lucide="phone" class="w-4 h-4"></i></div>
                            <div class="flex flex-col overflow-hidden">
                                <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest leading-none mb-1">Contacto</span>
                                <span class="text-xs font-bold text-slate-800 truncate leading-none" id="checkout-phone"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex-1 overflow-y-auto p-6 bg-slate-50/50 custom-scrollbar space-y-5">
                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-1.5 ml-1">Nombre Completo</label>
                        <div class="relative">
                            <i data-lucide="user" class="absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"></i>
                            <input required type="text" id="cust-name" class="w-full bg-white border border-slate-200 rounded-xl px-4 py-3.5 pl-10 focus:outline-none focus:ring-2 focus:ring-orange-500/30 font-medium" placeholder="Ej: Juan P칠rez">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-1.5 ml-1">Tu Tel칠fono</label>
                        <div class="relative">
                            <i data-lucide="phone" class="absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"></i>
                            <input required type="tel" id="cust-phone" class="w-full bg-white border border-slate-200 rounded-xl px-4 py-3.5 pl-10 focus:outline-none focus:ring-2 focus:ring-orange-500/30 font-medium" placeholder="Ej: 387 123456">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-1.5 ml-1">Horario de Retiro</label>
                        <div class="relative">
                            <i data-lucide="clock" class="absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"></i>
                            <input required type="time" id="cust-time" onchange="validateTime(this)" class="w-full bg-white border border-slate-200 rounded-xl px-4 py-3.5 pl-10 focus:outline-none focus:ring-2 focus:ring-orange-500/30 font-medium">
                        </div>
                        <p id="time-error" class="hidden text-xs font-bold text-red-500 mt-2 bg-red-50 p-2 rounded-lg border border-red-100"></p>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-1.5 ml-1">Notas (Opcional)</label>
                        <textarea id="cust-notes" class="w-full bg-white border border-slate-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-orange-500/30 min-h-[80px] resize-none font-medium text-sm" placeholder="쮸lguna aclaraci칩n?"></textarea>
                    </div>
                </div>

                <div class="p-5 border-t border-slate-100 bg-white flex-shrink-0 z-20">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-sm font-bold text-slate-500">Total a Pagar</span>
                        <span class="text-2xl font-black text-slate-900 tracking-tighter" id="checkout-total-display">$0</span>
                    </div>
                    <button type="submit" id="btn-confirm-order" class="w-full bg-slate-900 text-white font-black py-4 rounded-xl shadow-xl hover:bg-orange-600 transition-all duration-300 flex items-center justify-center gap-2">
                        CONFIRMAR PEDIDO <i data-lucide="check-circle-2" class="w-5 h-5"></i>
                    </button>
                </div>
            </form>

            <!-- Step 2: 칄xito (Oculto por defecto) -->
            <div id="checkout-success" class="hidden flex-col h-full bg-white">
                <div class="flex-1 overflow-y-auto p-8 text-center space-y-6 custom-scrollbar">
                    <div class="bg-amber-50 border border-amber-200 p-4 rounded-2xl flex items-center gap-4 text-left">
                        <i data-lucide="alert-circle" class="w-10 h-10 text-amber-600 shrink-0"></i>
                        <div>
                            <p class="text-amber-900 font-black text-xs uppercase tracking-wider mb-1">춰Paso Obligatorio!</p>
                            <p class="text-amber-800 text-sm font-medium">Envi치 el pedido por WhatsApp para confirmar tu retiro.</p>
                        </div>
                    </div>
                    <div>
                        <h2 class="text-3xl font-extrabold text-slate-900 mb-2 tracking-tighter italic uppercase font-heading">CASI LISTO...</h2>
                        <p class="text-slate-600 font-medium">Hac칠 clic abajo para enviar el pedido por WhatsApp.</p>
                    </div>
                    <button id="btn-send-whatsapp" class="w-full bg-green-600 text-white font-black py-5 rounded-2xl transition-all duration-300 hover:scale-105 shadow-xl shadow-green-600/30 flex items-center justify-center gap-3 animate-pulse">
                        <i data-lucide="message-circle" class="w-7 h-7"></i> ENVIAR POR WHATSAPP
                    </button>
                    <div class="bg-slate-50 p-5 rounded-2xl text-left border border-slate-100">
                        <p class="text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] mb-3">Resumen</p>
                        <ul id="success-summary" class="text-xs space-y-2 max-h-32 overflow-y-auto pr-2 custom-scrollbar"></ul>
                    </div>
                </div>
                <div class="p-5 border-t border-slate-100 bg-white z-20">
                     <button onclick="window.location.reload()" class="w-full bg-slate-900 text-white font-black py-4 rounded-xl hover:bg-slate-800 transition-all duration-300">
                        VOLVER AL INICIO
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- BOT칍N FLOTANTE CARRITO -->
    <div id="float-cart-btn" class="hidden fixed bottom-6 left-6 z-[90] animate-slide-up">
        <button onclick="toggleCart(true)" class="group flex items-center gap-3 bg-slate-900 text-white pl-4 pr-6 py-4 rounded-full shadow-2xl shadow-slate-900/40 border border-slate-700 hover:scale-105 active:scale-95 transition-all duration-300">
            <div class="relative">
                <div class="bg-orange-500 rounded-full p-2 text-white group-hover:bg-orange-400 transition-colors">
                    <i data-lucide="shopping-cart" class="w-5 h-5"></i>
                </div>
                <span id="float-count" class="absolute -top-1 -right-1 bg-white text-orange-600 text-[10px] font-black w-4 h-4 flex items-center justify-center rounded-full border-2 border-slate-900">0</span>
            </div>
            <div class="flex flex-col items-start">
                <span class="text-[10px] font-bold text-slate-400 uppercase tracking-wider leading-none mb-1">Tu Pedido</span>
                <span id="float-total" class="text-sm font-black text-white leading-none">$0</span>
            </div>
        </button>
    </div>

    <!-- GEMINI CHAT -->
    <div class="fixed bottom-6 right-6 z-[80] flex flex-col items-end">
        <div id="chat-window" class="hidden mb-4 w-[320px] sm:w-[380px] bg-white rounded-2xl shadow-2xl border border-slate-200 overflow-hidden flex flex-col h-[500px]">
            <div class="bg-orange-600 p-4 flex justify-between items-center text-white">
                <div class="flex items-center gap-2">
                    <i data-lucide="bot" class="w-5 h-5"></i>
                    <span class="font-bold">Chat Delicias Urbanas</span>
                </div>
                <button onclick="toggleChat()" class="hover:bg-orange-700 p-1 rounded transition-colors"><i data-lucide="x" class="w-5 h-5"></i></button>
            </div>
            <div id="chat-messages" class="flex-1 overflow-y-auto p-4 space-y-4">
                <div class="flex justify-start">
                    <div class="max-w-[85%] p-3 rounded-2xl text-sm bg-slate-100 text-slate-800 rounded-tl-none">
                        춰Hola! Soy el asistente virtual de Delicias Urbanas. 쯊e ayudo a elegir algo rico para comer hoy en Salta?
                    </div>
                </div>
            </div>
            <div class="p-4 border-t border-slate-100 flex gap-2">
                <input type="text" id="chat-input" placeholder="쯈u칠 hay de rico hoy?" class="flex-1 bg-slate-50 border border-slate-200 rounded-xl px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500/50" onkeypress="handleChatEnter(event)">
                <button onclick="sendMessage()" id="chat-send-btn" class="bg-orange-600 text-white p-2 rounded-xl hover:bg-orange-700 transition-colors"><i data-lucide="send" class="w-4 h-4"></i></button>
            </div>
        </div>
        <button onclick="toggleChat()" class="bg-orange-600 text-white p-4 rounded-full shadow-xl hover:bg-orange-700 transition-all hover:scale-110 active:scale-95">
            <i data-lucide="message-square" class="w-6 h-6"></i>
        </button>
    </div>

    <!-- L칍GICA PRINCIPAL -->
    <script>
        // --- INICIALIZACI칍N ---
        document.addEventListener('DOMContentLoaded', () => {
            initUI();
            renderCategories();
            renderMenu();
            renderCart();
            renderOrders();
            checkShopStatus();
            lucide.createIcons();
            setInterval(checkShopStatus, 1000);
        });

        function initUI() {
            // Llenar informaci칩n de la tienda
            document.querySelectorAll('[id^="header-logo"], [id^="hero-logo"], [id^="footer-logo"]').forEach(img => {
                img.src = SHOP_INFO.logoUrl;
                img.onerror = () => { img.src = 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?auto=format&fit=crop&q=80&w=100'; };
            });
            document.getElementById('hero-address').innerText = SHOP_INFO.address;
            document.getElementById('hero-instagram').href = SHOP_INFO.instagram;
            document.getElementById('hero-instagram-user').innerText = SHOP_INFO.instagramUser;
            
            document.getElementById('footer-address').innerText = SHOP_INFO.address;
            document.getElementById('footer-phone').innerText = SHOP_INFO.phoneDisplay;
            document.getElementById('footer-instagram-link').href = SHOP_INFO.instagram;

            document.getElementById('checkout-address').innerText = SHOP_INFO.address;
            document.getElementById('checkout-phone').innerText = SHOP_INFO.phoneDisplay;

            // Listener de b칰squeda
            document.getElementById('search-input').addEventListener('input', (e) => {
                searchQuery = e.target.value;
                renderMenu();
            });
        }

        // --- RENDERIZADO DEL MEN칔 ---
        function renderCategories() {
            const categories = [
                { name: 'Todos', icon: 'pizza' },
                { name: 'Pollo', icon: 'flame' },
                { name: 'S치ndwiches', icon: 'sandwich' },
                { name: 'Guarniciones', icon: 'ice-cream' },
                { name: 'Bebidas', icon: 'cup-soda' }
            ];
            
            const container = document.getElementById('category-container');
            container.innerHTML = categories.map(cat => `
                <button onclick="setCategory('${cat.name}')" 
                    class="px-6 py-3 rounded-2xl font-black transition-all duration-300 whitespace-nowrap flex items-center gap-3 text-sm active:scale-95 hover:scale-105 
                    ${selectedCategory === cat.name ? 'bg-orange-500 text-white shadow-xl shadow-orange-500/40' : 'bg-slate-50 text-slate-500 hover:bg-slate-100'}">
                    <i data-lucide="${cat.icon}" class="w-4 h-4"></i> ${cat.name.toUpperCase()}
                </button>
            `).join('');
            lucide.createIcons();
        }

        function setCategory(cat) {
            selectedCategory = cat;
            renderCategories(); // Actualizar estado visual
            renderMenu();
        }

        function renderMenu() {
            const grid = document.getElementById('product-grid');
            const title = document.getElementById('menu-title');
            
            title.innerText = selectedCategory === 'Todos' ? 'NUESTRO MEN칔' : selectedCategory.toUpperCase();

            const filtered = MENU_ITEMS.filter(item => {
                const matchCat = selectedCategory === 'Todos' || item.category === selectedCategory;
                const matchSearch = item.name.toLowerCase().includes(searchQuery.toLowerCase()) || 
                                    item.description.toLowerCase().includes(searchQuery.toLowerCase());
                return matchCat && matchSearch;
            });

            if (filtered.length === 0) {
                grid.innerHTML = `
                    <div class="col-span-full text-center py-20 bg-white rounded-3xl border-2 border-dashed border-slate-200">
                        <p class="text-slate-400 text-lg font-bold">No encontramos esa delicia...</p>
                        <button onclick="setCategory('Todos'); document.getElementById('search-input').value='';" class="mt-4 text-orange-600 font-extrabold hover:underline">Ver todo el men칰</button>
                    </div>`;
                return;
            }

            grid.innerHTML = filtered.map(item => `
                <div class="group relative bg-white rounded-[2rem] p-6 border border-slate-200/60 shadow-sm hover:shadow-2xl hover:shadow-orange-500/10 hover:border-orange-500/30 transition-all duration-300 flex flex-col justify-between h-full min-h-[240px]">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-orange-50 rounded-bl-[100%] rounded-tr-[2rem] opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"></div>
                    <div class="relative z-10">
                        <div class="mb-4">
                            <span class="inline-block px-3 py-1 rounded-full bg-slate-100 text-[10px] font-black uppercase tracking-widest text-slate-500 group-hover:bg-orange-100 group-hover:text-orange-600 transition-colors duration-300">
                                ${item.category}
                            </span>
                        </div>
                        <h3 class="text-2xl font-black text-slate-900 italic uppercase leading-none tracking-tight mb-3 group-hover:text-orange-600 transition-colors duration-300">
                            ${item.name}
                        </h3>
                        <p class="text-slate-500 text-sm font-medium leading-relaxed line-clamp-3">${item.description}</p>
                    </div>
                    <div class="relative z-10 mt-8 pt-6 border-t border-slate-100 flex items-center justify-between">
                        <div class="flex flex-col">
                            <span class="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-0.5">Precio</span>
                            <span class="text-2xl font-black text-slate-900 tracking-tighter">$${item.price.toLocaleString('es-AR')}</span>
                        </div>
                        <button onclick="addToCart('${item.id}')" class="bg-slate-900 hover:bg-orange-500 text-white w-12 h-12 rounded-2xl flex items-center justify-center transition-all duration-300 shadow-lg hover:scale-105 active:scale-95">
                            <i data-lucide="plus" class="w-5 h-5"></i>
                        </button>
                    </div>
                </div>
            `).join('');
            lucide.createIcons();
        }

        // --- L칍GICA DEL CARRITO ---
        function addToCart(id) {
            const product = MENU_ITEMS.find(p => p.id === id);
            const existing = cart.find(i => i.id === id);
            
            if (existing) {
                existing.quantity++;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            renderCart();
            // YA NO SE ABRE EL CARRITO AUTOM츼TICAMENTE
            // toggleCart(true); 
        }

        function updateQty(id, delta) {
            const item = cart.find(i => i.id === id);
            if (item) {
                item.quantity += delta;
                if (item.quantity <= 0) {
                    cart = cart.filter(i => i.id !== id);
                }
                renderCart();
            }
        }

        function removeCartItem(id) {
            cart = cart.filter(i => i.id !== id);
            renderCart();
        }

        function renderCart() {
            const container = document.getElementById('cart-items-container');
            const totalDisplay = document.getElementById('cart-total');
            const cartFooter = document.getElementById('cart-footer');
            const badge = document.getElementById('cart-badge');
            const floatBtn = document.getElementById('float-cart-btn');
            
            const totalItems = cart.reduce((sum, i) => sum + i.quantity, 0);
            const totalMoney = cart.reduce((sum, i) => sum + (i.price * i.quantity), 0);

            // Badge
            badge.innerText = totalItems;
            badge.classList.toggle('hidden', totalItems === 0);

            // Bot칩n flotante
            floatBtn.classList.toggle('hidden', totalItems === 0);
            document.getElementById('float-count').innerText = totalItems;
            document.getElementById('float-total').innerText = '$' + totalMoney.toLocaleString('es-AR');

            if (cart.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-20 bg-slate-50 rounded-3xl border-2 border-dashed border-slate-200">
                        <i data-lucide="shopping-bag" class="w-12 h-12 text-slate-300 mx-auto mb-4"></i>
                        <p class="text-slate-500 font-medium">Tu carrito est치 vac칤o.</p>
                        <button onclick="toggleCart(false)" class="mt-4 text-orange-600 font-black text-sm uppercase tracking-wide hover:underline">Ir al men칰</button>
                    </div>`;
                cartFooter.classList.add('hidden');
            } else {
                container.innerHTML = `<ul class="space-y-4">` + cart.map(item => `
                    <li class="p-4 bg-slate-50 rounded-2xl border border-slate-100 flex gap-4">
                         <div class="h-12 w-12 flex-shrink-0 rounded-xl bg-white border border-slate-200 flex items-center justify-center text-orange-500">
                            <i data-lucide="utensils" class="w-5 h-5"></i>
                         </div>
                         <div class="flex flex-1 flex-col justify-between">
                            <div class="flex justify-between items-start">
                                <h3 class="text-sm font-black text-slate-900 uppercase italic leading-tight">${item.name}</h3>
                                <p class="ml-4 font-bold text-slate-900 text-sm">$${(item.price * item.quantity).toLocaleString('es-AR')}</p>
                            </div>
                            <div class="flex items-end justify-between mt-3">
                                <div class="flex items-center bg-white border border-slate-200 rounded-lg h-8">
                                    <button onclick="updateQty('${item.id}', -1)" class="w-8 h-full flex items-center justify-center text-slate-400 hover:text-slate-600"><i data-lucide="minus" class="w-3 h-3"></i></button>
                                    <span class="w-8 text-center text-sm font-black text-slate-900">${item.quantity}</span>
                                    <button onclick="updateQty('${item.id}', 1)" class="w-8 h-full flex items-center justify-center text-slate-400 hover:text-slate-600"><i data-lucide="plus" class="w-3 h-3"></i></button>
                                </div>
                                <button onclick="removeCartItem('${item.id}')" class="p-2 text-slate-400 hover:text-red-500"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                            </div>
                         </div>
                    </li>
                `).join('') + `</ul>`;
                
                totalDisplay.innerText = '$' + totalMoney.toLocaleString('es-AR');
                cartFooter.classList.remove('hidden');
            }
            lucide.createIcons();
        }

        // --- DRAWERS & MODALS ---
        function toggleCart(show) {
            const drawer = document.getElementById('cart-drawer');
            const panel = document.getElementById('cart-drawer-panel');
            if (show) {
                drawer.classList.remove('hidden');
                setTimeout(() => panel.classList.add('drawer-open'), 10);
            } else {
                panel.classList.remove('drawer-open');
                setTimeout(() => drawer.classList.add('hidden'), 300);
            }
        }

        function toggleOrders(show) {
            const drawer = document.getElementById('orders-drawer');
            const panel = document.getElementById('orders-drawer-panel');
            if (show) {
                drawer.classList.remove('hidden');
                setTimeout(() => panel.classList.add('drawer-open'), 10);
            } else {
                panel.classList.remove('drawer-open');
                setTimeout(() => drawer.classList.add('hidden'), 300);
            }
        }

        // --- CHECKOUT ---
        let tempOrderDetails = {};

        function openCheckout() {
            toggleCart(false);
            const modal = document.getElementById('checkout-modal');
            const totalMoney = cart.reduce((sum, i) => sum + (i.price * i.quantity), 0);
            document.getElementById('checkout-total-display').innerText = '$' + totalMoney.toLocaleString('es-AR');
            document.getElementById('cust-time').value = "";
            document.getElementById('time-error').classList.add('hidden');
            
            // Reset
            document.getElementById('checkout-form').classList.remove('hidden');
            document.getElementById('checkout-success').classList.remove('flex');
            document.getElementById('checkout-success').classList.add('hidden');
            
            modal.classList.add('modal-open');
        }

        function closeCheckout() {
            document.getElementById('checkout-modal').classList.remove('modal-open');
        }

        function validateTime(input) {
            const time = input.value;
            const errorMsg = document.getElementById('time-error');
            const btn = document.getElementById('btn-confirm-order');

            if (!time) return false;

            const day = new Date().getDay();
            if (day === 0) { // Domingo
                errorMsg.innerText = "Los domingos estamos cerrados.";
                errorMsg.classList.remove('hidden');
                btn.disabled = true;
                btn.classList.add('opacity-50', 'cursor-not-allowed');
                return false;
            }

            const [h, m] = time.split(':').map(Number);
            const totalMins = h * 60 + m;
            // 08:00 (480) - 15:00 (900) y 17:30 (1050) - 21:00 (1260)
            const isMorning = totalMins >= 480 && totalMins <= 900;
            const isAfternoon = totalMins >= 1050 && totalMins <= 1260;

            if (!isMorning && !isAfternoon) {
                errorMsg.innerText = "Cerrado a esta hora (08-15hs / 17:30-21hs)";
                errorMsg.classList.remove('hidden');
                btn.disabled = true;
                btn.classList.add('opacity-50', 'cursor-not-allowed');
                return false;
            }

            errorMsg.classList.add('hidden');
            btn.disabled = false;
            btn.classList.remove('opacity-50', 'cursor-not-allowed');
            return true;
        }

        function handleCheckoutSubmit(e) {
            e.preventDefault();
            const timeInput = document.getElementById('cust-time');
            if (!validateTime(timeInput)) return;

            tempOrderDetails = {
                name: document.getElementById('cust-name').value,
                phone: document.getElementById('cust-phone').value,
                time: timeInput.value,
                notes: document.getElementById('cust-notes').value
            };

            // Guardar local
            const totalMoney = cart.reduce((sum, i) => sum + (i.price * i.quantity), 0);
            const newOrder = {
                id: Math.random().toString(36).substr(2, 9).toUpperCase(),
                details: tempOrderDetails,
                items: [...cart],
                total: totalMoney,
                timestamp: Date.now(),
                status: 'Pendiente'
            };
            orders.unshift(newOrder);
            localStorage.setItem('delicias_urbanas_orders', JSON.stringify(orders));
            renderOrders();

            // Preparar WhatsApp
            const itemsText = cart.map(i => ` ${i.quantity}x ${i.name} ($${(i.price*i.quantity).toLocaleString('es-AR')})`).join('%0A');
            const msg = `춰Hola Delicias Urbanas! 游녦%0A%0A*NUEVO PEDIDO*%0A------------------%0A游녻 ${tempOrderDetails.name}%0A游 ${tempOrderDetails.phone}%0A游 Retiro: ${tempOrderDetails.time} hs%0A------------------%0A${itemsText}%0A------------------%0A游눯 TOTAL: $${totalMoney.toLocaleString('es-AR')}` + (tempOrderDetails.notes ? `%0A游닇 ${tempOrderDetails.notes}` : '');
            
            const waBtn = document.getElementById('btn-send-whatsapp');
            waBtn.onclick = () => {
                window.open(`https://wa.me/${SHOP_INFO.phone}?text=${msg}`, '_blank');
                cart = []; // Limpiar carrito al enviar
                renderCart();
            };

            // Resumen de 칠xito
            const summaryList = document.getElementById('success-summary');
            summaryList.innerHTML = cart.map(i => `<li class="flex justify-between border-b border-slate-200/50 pb-1"><span>${i.quantity}x ${i.name}</span><span class="font-bold">$${(i.price * i.quantity).toLocaleString('es-AR')}</span></li>`).join('');
            
            document.getElementById('checkout-form').classList.add('hidden');
            document.getElementById('checkout-success').classList.remove('hidden');
            document.getElementById('checkout-success').classList.add('flex');
        }

        // --- PEDIDOS ---
        function renderOrders() {
            const container = document.getElementById('orders-list');
            if (orders.length === 0) {
                container.innerHTML = `<p class="text-center text-slate-400">No hay pedidos recientes.</p>`;
                return;
            }
            container.innerHTML = orders.map(o => `
                <div class="bg-slate-50 rounded-2xl p-5 border border-slate-100 relative overflow-hidden mb-4">
                    <div class="absolute top-0 right-0 px-3 py-1 text-[10px] font-black uppercase text-white ${o.status === 'Pendiente' ? 'bg-orange-500' : 'bg-red-500'}">${o.status}</div>
                    <div class="mb-3">
                         <p class="text-xs font-bold text-slate-400">#${o.id.slice(-6)}</p>
                         <p class="text-sm font-black text-slate-800"><i data-lucide="clock" class="inline w-3 h-3"></i> ${o.details.time || o.details.pickupTime} hs</p>
                    </div>
                    <ul class="space-y-1 mb-4 text-xs">
                        ${o.items.map(i => `<li class="flex justify-between"><span>${i.quantity}x ${i.name}</span><b>$${(i.price*i.quantity).toLocaleString('es-AR')}</b></li>`).join('')}
                    </ul>
                    <div class="flex justify-between items-center pt-3 border-t border-slate-200">
                        <span class="text-lg font-black">$${o.total.toLocaleString('es-AR')}</span>
                        ${o.status === 'Pendiente' ? `<button onclick="cancelOrder('${o.id}')" class="text-xs bg-red-50 text-red-600 px-3 py-2 rounded-lg font-bold hover:bg-red-100">CANCELAR</button>` : ''}
                    </div>
                </div>
            `).join('');
            lucide.createIcons();
        }

        function cancelOrder(id) {
            if(!confirm('쯉eguro quer칠s cancelar este pedido?')) return;
            orders = orders.map(o => o.id === id ? {...o, status: 'Cancelado'} : o);
            localStorage.setItem('delicias_urbanas_orders', JSON.stringify(orders));
            renderOrders();
            // WhatsApp Cancel
            const order = orders.find(o => o.id === id);
            const msg = `丘멆잺 *CANCELACI칍N*%0AOrden #${id.slice(-6)}%0ADisculpen las molestias.`;
            window.open(`https://wa.me/${SHOP_INFO.phone}?text=${msg}`, '_blank');
        }

        // --- ESTADO Y APERTURA ---
        function checkShopStatus() {
            const now = new Date();
            const day = now.getDay();
            const mins = now.getHours() * 60 + now.getMinutes();
            // 8:00=480, 15:00=900, 17:30=1050, 21:00=1260
            const isOpen = (day !== 0) && ((mins >= 480 && mins < 900) || (mins >= 1050 && mins < 1260));
            
            const dot = document.getElementById('status-dot');
            const ping = document.getElementById('status-dot-ping');
            const text = document.getElementById('status-text');

            if (isOpen) {
                dot.className = "relative inline-flex size-2 rounded-full bg-emerald-500";
                ping.className = "absolute inline-flex h-full w-full animate-ping rounded-full opacity-75 bg-emerald-400";
                text.innerText = "춰ABIERTO AHORA!";
            } else {
                dot.className = "relative inline-flex size-2 rounded-full bg-red-500";
                ping.className = "hidden";
                text.innerText = "CERRADO";
            }
        }
        
        function openWhatsApp() {
            window.open(`https://wa.me/${SHOP_INFO.phone}`, "_blank");
        }

    </script>

    <!-- GEMINI MODULE -->
    <script type="module">
        import { GoogleGenAI } from "@google/genai";
        
        // --- API KEY ---
        // Al usar HTML puro sin compilaci칩n (Build), no hay process.env.
        // Debes poner tu clave aqu칤 manualmente o manejar el error.
        const API_KEY = ""; 
        
        let ai = null;
        if (API_KEY) {
            try {
                ai = new GoogleGenAI({ apiKey: API_KEY });
            } catch(e) { console.error("Error init AI", e); }
        }

        window.toggleChat = () => {
            const chat = document.getElementById('chat-window');
            chat.classList.toggle('hidden');
            if(!chat.classList.contains('hidden')) {
                document.getElementById('chat-messages').scrollTop = document.getElementById('chat-messages').scrollHeight;
            }
        };

        window.handleChatEnter = (e) => {
            if (e.key === 'Enter') sendMessage();
        };

        window.sendMessage = async () => {
            const input = document.getElementById('chat-input');
            const container = document.getElementById('chat-messages');
            const txt = input.value.trim();
            if (!txt) return;

            // Mensaje usuario
            container.innerHTML += `
                <div class="flex justify-end animate-fade-in">
                    <div class="max-w-[85%] p-3 rounded-2xl text-sm bg-orange-500 text-white rounded-tr-none">${txt}</div>
                </div>`;
            input.value = '';
            container.scrollTop = container.scrollHeight;

            // Loading
            const loadingId = 'loading-' + Date.now();
            container.innerHTML += `
                <div id="${loadingId}" class="flex justify-start animate-fade-in">
                    <div class="bg-slate-100 p-3 rounded-2xl rounded-tl-none text-slate-500 text-xs">Pensando...</div>
                </div>`;
            container.scrollTop = container.scrollHeight;

            if (!ai) {
                 document.getElementById(loadingId).innerText = "Chat no disponible (Falta API Key).";
                 return;
            }

            try {
                const menuContext = MENU_ITEMS.map(i => `${i.name}: $${i.price} - ${i.description}`).join('\n');
                const response = await ai.models.generateContent({
                    model: 'gemini-2.5-flash',
                    contents: `Sos un asistente de '${SHOP_INFO.name}' en Salta. Ayud치 a elegir comida.
                    Men칰: ${menuContext}. 
                    Cliente dice: ${txt}`
                });
                
                document.getElementById(loadingId).remove();
                container.innerHTML += `
                    <div class="flex justify-start animate-fade-in">
                        <div class="max-w-[85%] p-3 rounded-2xl text-sm bg-slate-100 text-slate-800 rounded-tl-none">${response.text}</div>
                    </div>`;
            } catch (error) {
                console.error(error);
                document.getElementById(loadingId).innerText = "Error de conexi칩n.";
            }
            container.scrollTop = container.scrollHeight;
        };
    </script>
</body>
</html>